<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="./">
    <title>第3章：采样理论与重建基础</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>目录</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="搜索..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-item " >
                        <a href="index.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">3D 网格生成完整教程</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter1.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第1章：3D表示基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter2.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第2章：几何处理基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item active" >
                        <a href="chapter3.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第3章：采样理论与重建基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter4.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第4章：Marching Cubes与体素方法</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter5.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第5章：Poisson表面重建</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter6.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第6章：基于Delaunay的重建方法</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter7.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第7章：神经隐式表示基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter8.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第8章：DeepSDF与Occupancy Networks</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter9.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第9章：可微分网格提取</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter10.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第10章：基于变形的网格生成</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter11.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第11章：参数化曲面方法</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter12.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第12章：序列生成方法</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter13.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第13章：3D扩散模型基础</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter14.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第14章：文本/图像驱动的3D生成</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter15.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第15章：前馈式快速生成</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter16.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第16章：多视图重建与新型表示</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="CLAUDE.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">1) 经典几何重建：点云/体素 → 网格</span>
                        </a>
                    </div>
                </nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="3">第3章：采样理论与重建基础</h1>
<h2 id="_1">章节大纲</h2>
<ol>
<li>
<p><strong>开篇介绍</strong>
   - 采样与重建的基本问题
   - 本章学习目标</p>
</li>
<li>
<p><strong>3.1 Nyquist-Shannon采样定理在3D中的应用</strong>
   - 一维采样定理回顾
   - 二维图像采样扩展
   - 三维空间采样理论
   - 频域分析与带限函数
   - 采样密度与重建质量关系</p>
</li>
<li>
<p><strong>3.2 Voronoi图与Delaunay三角化</strong>
   - Voronoi图的定义与性质
   - Delaunay三角化的对偶关系
   - 空圆性质与最大最小角性质
   - 增量构造与分治算法
   - 高维推广与应用</p>
</li>
<li>
<p><strong>3.3 点云采样策略</strong>
   - 均匀采样与随机采样
   - 泊松盘采样
   - 蓝噪声采样
   - 自适应采样
   - 特征保持采样</p>
</li>
<li>
<p><strong>3.4 重建的适定性分析</strong>
   - Hadamard适定性条件
   - 重建问题的唯一性
   - 稳定性与条件数
   - 正则化方法
   - 噪声鲁棒性</p>
</li>
<li>
<p><strong>本章小结</strong></p>
</li>
<li><strong>练习题</strong></li>
<li><strong>常见陷阱与错误</strong></li>
</ol>
<hr />
<h2 id="_2">开篇介绍</h2>
<p>三维网格重建的核心挑战在于如何从离散采样点恢复连续曲面。本章深入探讨采样理论的数学基础，建立从连续到离散、再从离散到连续的理论框架。我们将学习如何确定最优采样密度、理解重建算法的理论保证，以及分析重建问题的数学性质。</p>
<p><strong>学习目标：</strong></p>
<ul>
<li>掌握三维空间中的采样定理及其对重建质量的影响</li>
<li>理解Voronoi图与Delaunay三角化在几何重建中的核心作用</li>
<li>学会设计和评估不同的点云采样策略</li>
<li>能够分析重建问题的适定性并选择合适的正则化方法</li>
</ul>
<h2 id="31-nyquist-shannon3d">3.1 Nyquist-Shannon采样定理在3D中的应用</h2>
<h3 id="311">3.1.1 从一维到三维的理论扩展</h3>
<p>经典的Nyquist-Shannon采样定理告诉我们：对于带限信号$f(t)$，如果其傅里叶变换$\hat{f}(\omega)$在$|\omega| &gt; W$时为零，则采样频率$f_s \geq 2W$（Nyquist频率）时可以完美重建原信号。</p>
<p>一维重建公式：
$$f(t) = \sum_{n=-\infty}^{\infty} f(nT) \cdot \text{sinc}\left(\frac{t-nT}{T}\right)$$
其中$T = 1/f_s$是采样间隔，$\text{sinc}(x) = \sin(\pi x)/(\pi x)$。</p>
<h3 id="312">3.1.2 三维带限函数</h3>
<p>在三维空间中，考虑函数$f: \mathbb{R}^3 \rightarrow \mathbb{R}$，其三维傅里叶变换为：
$$\hat{f}(\boldsymbol{\omega}) = \int_{\mathbb{R}^3} f(\mathbf{x}) e^{-i\boldsymbol{\omega} \cdot \mathbf{x}} d\mathbf{x}$$
带限条件变为：$\hat{f}(\boldsymbol{\omega}) = 0$ 当 $|\boldsymbol{\omega}| &gt; W$</p>
<p>对于各向同性采样（采样间隔$\Delta$），Nyquist条件要求：
$$\Delta \leq \frac{\pi}{W}$$</p>
<h3 id="313">3.1.3 表面采样的特殊性</h3>
<p>对于二维流形嵌入在三维空间的情况，采样理论更加复杂：</p>
<ol>
<li><strong>局部参数化采样</strong>：在局部切平面上应用2D采样理论</li>
<li><strong>测地距离考虑</strong>：采样密度应基于曲面测地距离而非欧氏距离</li>
<li><strong>曲率自适应</strong>：高曲率区域需要更密集的采样</li>
</ol>
<p>局部采样密度公式：
$$\rho(\mathbf{p}) = \rho_0 \cdot \max\left(1, \frac{|\kappa_1(\mathbf{p})| + |\kappa_2(\mathbf{p})|}{2\epsilon}\right)$$
其中$\kappa_1, \kappa_2$是主曲率，$\epsilon$是重建误差容限。</p>
<h3 id="314">3.1.4 混叠与重建滤波器</h3>
<p>采样不足导致的混叠在3D中表现为：</p>
<ul>
<li>细节丢失</li>
<li>拓扑错误（洞的产生或消失）</li>
<li>法向翻转</li>
</ul>
<p>理想低通滤波器在3D中：
$$H(\boldsymbol{\omega}) = \begin{cases}
1, &amp; |\boldsymbol{\omega}| \leq W \\
0, &amp; |\boldsymbol{\omega}| &gt; W
\end{cases}$$
实际应用中常用的重建核：</p>
<ul>
<li><strong>三线性插值</strong>：$K(\mathbf{x}) = \prod_{i=1}^3 \max(0, 1-|x_i|)$</li>
<li><strong>高斯核</strong>：$K(\mathbf{x}) = \exp(-|\mathbf{x}|^2/2\sigma^2)$</li>
<li><strong>Wendland核</strong>：紧支撑且光滑</li>
</ul>
<h2 id="32-voronoidelaunay">3.2 Voronoi图与Delaunay三角化</h2>
<h3 id="321-voronoi">3.2.1 Voronoi图的数学定义</h3>
<p>给定点集$P = \{p_1, ..., p_n\} \subset \mathbb{R}^d$，点$p_i$的Voronoi区域定义为：
$$V(p_i) = \{x \in \mathbb{R}^d : |x - p_i| \leq |x - p_j|, \forall j \neq i\}$$
Voronoi图$\text{Vor}(P)$是所有Voronoi区域的集合。</p>
<p><strong>关键性质：</strong></p>
<ol>
<li>Voronoi区域是凸多面体</li>
<li>相邻区域共享一个$(d-1)$维面</li>
<li>Voronoi顶点等距于至少$d+1$个采样点</li>
</ol>
<h3 id="322-delaunay">3.2.2 Delaunay三角化的对偶性</h3>
<p>Delaunay三角化$\text{Del}(P)$是Voronoi图的对偶结构：</p>
<ul>
<li>若两个Voronoi区域相邻，对应点在Delaunay中相连</li>
<li>Delaunay单纯形的外接球不包含其他点（空球性质）</li>
</ul>
<div class="codehilite"><pre><span></span><code>    Voronoi图                Delaunay三角化

    +---+---+               A-----B
    | A | B |               |\   /|
    +---+---+               | \ / |
    | C | D |               |  X  |
    +---+---+               | / \ |
                            |/   \|
                            C-----D
</code></pre></div>

<h3 id="323">3.2.3 空圆性质与优化性</h3>
<p>Delaunay三角化满足<strong>空圆性质</strong>：任何三角形的外接圆内部不包含其他采样点。</p>
<p>这导致了重要的优化性质：</p>
<ol>
<li><strong>最大化最小角</strong>：在所有可能的三角化中，Delaunay三角化最大化最小角</li>
<li><strong>最小化最大外接圆</strong>：局部最优性</li>
</ol>
<p>数学表述：
$$\text{Del}(P) = \arg\max_{T \in \mathcal{T}(P)} \min_{\triangle \in T} \min_{\theta \in \triangle} \theta$$</p>
<h3 id="324">3.2.4 增量构造算法</h3>
<p>Bowyer-Watson算法的关键步骤：</p>
<ol>
<li>初始化超级三角形包含所有点</li>
<li>对每个新点$p$：
   - 找出所有外接圆包含$p$的三角形（冲突三角形）
   - 删除这些三角形，形成空腔
   - 将$p$与空腔边界连接</li>
</ol>
<p>时间复杂度：$O(n^{\lceil d/2 \rceil})$，3D中为$O(n^2)$</p>
<h3 id="325-delaunay">3.2.5 受限Delaunay与曲面重建</h3>
<p>对于曲面重建，需要<strong>受限Delaunay三角化</strong>：</p>
<ul>
<li>保持输入的边界约束</li>
<li>在约束条件下最大化Delaunay性质</li>
</ul>
<p>受限Delaunay的存在性条件：
$$\text{对于约束边}e, \exists \text{空球}B: e \subset \partial B$$</p>
<h2 id="33">3.3 点云采样策略</h2>
<h3 id="331">3.3.1 均匀采样与随机采样</h3>
<p><strong>均匀网格采样</strong>：</p>
<ul>
<li>优点：实现简单，采样密度可控</li>
<li>缺点：可能产生规则伪影，不适应曲面特征</li>
</ul>
<p>均匀采样的谱特性：
$$S_{\text{uniform}}(\mathbf{k}) = \sum_{n} \delta(\mathbf{k} - 2\pi n/\Delta)$$
<strong>随机采样</strong>：</p>
<ul>
<li>优点：避免规则伪影</li>
<li>缺点：可能产生聚集和空隙</li>
</ul>
<p>随机采样的功率谱密度为白噪声：
$$P_{\text{random}}(\omega) = \text{const}$$</p>
<h3 id="332-poisson-disk-sampling">3.3.2 泊松盘采样（Poisson Disk Sampling）</h3>
<p>泊松盘采样保证任意两点间距离至少为$r$（泊松盘半径）：
$$|p_i - p_j| \geq r, \forall i \neq j$$
<strong>Bridson算法</strong>（Fast Poisson Disk Sampling）：</p>
<ol>
<li>初始化背景网格，单元大小$r/\sqrt{d}$</li>
<li>随机选择初始点，加入活跃列表</li>
<li>从活跃列表选点，在其周围环形区域生成候选点</li>
<li>检查候选点是否满足距离约束</li>
<li>重复直到活跃列表为空</li>
</ol>
<p>时间复杂度：$O(n)$，其中$n$是最终采样点数</p>
<h3 id="333">3.3.3 蓝噪声采样</h3>
<p>蓝噪声特性：低频能量少，高频能量多，径向平均功率谱：
$$P_{\text{blue}}(f) \propto f^\alpha, \alpha &gt; 0$$
理想蓝噪声的径向分布函数：
$$g(r) = \begin{cases}
0, &amp; r &lt; r_{\min} \\
\text{逐渐增长到1}, &amp; r \geq r_{\min}
\end{cases}$$
<strong>Lloyd松弛算法</strong>：</p>
<ol>
<li>计算Voronoi图</li>
<li>将每个采样点移动到其Voronoi区域质心</li>
<li>迭代直到收敛</li>
</ol>
<p>质心计算：
$$c_i = \frac{\int_{V(p_i)} x \cdot \rho(x) dx}{\int_{V(p_i)} \rho(x) dx}$$</p>
<h3 id="334">3.3.4 自适应采样</h3>
<p>根据局部几何特征调整采样密度：</p>
<p><strong>曲率驱动采样</strong>：
$$\rho(\mathbf{p}) = \rho_{\min} + (\rho_{\max} - \rho_{\min}) \cdot \frac{|\kappa(\mathbf{p})|}{|\kappa|_{\max}}$$
<strong>特征敏感采样</strong>：</p>
<ol>
<li>计算局部特征强度（如DoG、Harris角点）</li>
<li>根据特征强度分配采样概率</li>
<li>使用重要性采样生成点</li>
</ol>
<p><strong>误差驱动采样</strong>（迭代细化）：</p>
<div class="codehilite"><pre><span></span><code><span class="k">while</span><span class="w"> </span>重建误差<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span>阈值:
<span class="w">    </span>计算当前重建的<span class="nv">Hausdorff</span>距离
<span class="w">    </span>在高误差区域增加采样点
<span class="w">    </span>更新重建
</code></pre></div>

<h3 id="335">3.3.5 特征保持采样</h3>
<p>保持尖锐特征的采样策略：</p>
<p><strong>特征线采样</strong>：</p>
<ol>
<li>检测特征边（二面角阈值）</li>
<li>沿特征线密集采样</li>
<li>在光滑区域稀疏采样</li>
</ol>
<p><strong>角点保护</strong>：</p>
<ul>
<li>确保所有角点（度数≥3的特征点）被采样</li>
<li>在角点周围增加采样密度</li>
</ul>
<p>特征检测准则：
$$\text{特征边}: |\theta_{ij}| &gt; \theta_{\text{threshold}}$$
$$\text{角点}: \sum_{e \in E(v)} I[\text{特征边}(e)] \geq 3$$</p>
<h2 id="34">3.4 重建的适定性分析</h2>
<h3 id="341-hadamard">3.4.1 Hadamard适定性条件</h3>
<p>一个数学问题称为<strong>适定的（well-posed）</strong>，如果满足：</p>
<ol>
<li><strong>存在性</strong>：解存在</li>
<li><strong>唯一性</strong>：解唯一</li>
<li><strong>稳定性</strong>：解连续依赖于输入数据</li>
</ol>
<p>曲面重建问题的抽象形式：
$$\mathcal{R}: \mathcal{P} \rightarrow \mathcal{S}$$
其中$\mathcal{P}$是点云空间，$\mathcal{S}$是曲面空间。</p>
<h3 id="342">3.4.2 重建唯一性的充分条件</h3>
<p><strong>ε-采样定理</strong>（Amenta &amp; Bern）：
若点集$P$是曲面$S$的ε-采样（$\epsilon &lt; 1$），即：
$$\forall x \in S, \exists p \in P: |x - p| \leq \epsilon \cdot \text{lfs}(x)$$
其中$\text{lfs}(x)$是局部特征尺寸（到中轴的距离），则：</p>
<ol>
<li>Delaunay三角化包含正确的曲面三角形</li>
<li>重建拓扑正确</li>
</ol>
<h3 id="343">3.4.3 稳定性与条件数分析</h3>
<p>重建算子的条件数：
$$\kappa(\mathcal{R}) = |\mathcal{R}| \cdot |\mathcal{R}^{-1}|$$
对于线性重建问题$Ax = b$：
$$\kappa(A) = \frac{\sigma_{\max}(A)}{\sigma_{\min}(A)}$$
<strong>噪声放大因子</strong>：
$$\frac{|\delta x|}{|x|} \leq \kappa(A) \cdot \frac{|\delta b|}{|b|}$$</p>
<h3 id="344">3.4.4 正则化方法</h3>
<p>对于病态问题，引入正则化项：</p>
<p><strong>Tikhonov正则化</strong>：
$$\min_S |P - S|^2 + \lambda \cdot R(S)$$
常用正则化项：</p>
<ol>
<li><strong>薄板样条能量</strong>：$R(S) = \int_S (\kappa_1^2 + \kappa_2^2) dS$</li>
<li><strong>总变分</strong>：$R(S) = \int_S |\nabla S| dS$</li>
<li><strong>拉普拉斯正则化</strong>：$R(S) = \int_S |\Delta S|^2 dS$</li>
</ol>
<p><strong>L-曲线方法</strong>选择正则化参数：
绘制$\log |P - S(\lambda)|^2$ vs $\log R(S(\lambda))$，选择曲线拐点处的$\lambda$。</p>
<h3 id="345">3.4.5 噪声鲁棒性分析</h3>
<p>考虑带噪声的点云：$\tilde{P} = P + \mathcal{N}(0, \sigma^2 I)$</p>
<p><strong>移动最小二乘（MLS）</strong>投影的鲁棒性：
$$f(x) = \arg\min_p \sum_{p_i \in N(x)} w(x, p_i) \cdot |p - p_i|^2$$
权重函数：$w(x, p_i) = \exp(-|x - p_i|^2/h^2)$</p>
<p>带宽$h$的选择：</p>
<ul>
<li>过小：对噪声敏感</li>
<li>过大：过度平滑</li>
</ul>
<p>最优带宽（基于偏差-方差权衡）：
$$h_{\text{opt}} \propto \left(\frac{\sigma^2}{n \cdot |\nabla^2 f|^2}\right)^{1/6}$$</p>
<h2 id="_3">本章小结</h2>
<h3 id="_4">核心概念回顾</h3>
<ol>
<li>
<p><strong>采样定理的3D推广</strong>：
   - Nyquist频率：$f_s \geq 2W_{\max}$
   - 曲面采样密度：$\rho \propto \max(|\kappa_1|, |\kappa_2|)$
   - 带限重建的理论保证</p>
</li>
<li>
<p><strong>Voronoi-Delaunay对偶性</strong>：
   - Voronoi图定义空间分割
   - Delaunay三角化提供最优连接
   - 空球性质保证几何质量</p>
</li>
<li>
<p><strong>采样策略层次</strong>：
   - 白噪声（随机）→ 蓝噪声（泊松盘）→ 自适应采样
   - 特征保持采样确保拓扑正确</p>
</li>
<li>
<p><strong>重建适定性</strong>：
   - ε-采样保证拓扑正确性
   - 正则化处理病态问题
   - 噪声鲁棒性通过MLS等方法实现</p>
</li>
</ol>
<h3 id="_5">关键公式汇总</h3>
<p>| 概念 | 公式 | 说明 |</p>
<table>
<thead>
<tr>
<th>概念</th>
<th>公式</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>3D Nyquist条件</td>
<td>$\Delta \leq \pi/W$</td>
<td>采样间隔上界</td>
</tr>
<tr>
<td>曲率自适应密度</td>
<td>$\rho(\mathbf{p}) = \rho_0 \cdot \max(1, |\kappa|/\epsilon)$</td>
<td>局部采样密度</td>
</tr>
<tr>
<td>Voronoi区域</td>
<td>$V(p_i) = \{x: |x-p_i| \leq |x-p_j|, \forall j\}$</td>
<td>最近邻分割</td>
</tr>
<tr>
<td>泊松盘约束</td>
<td>$|p_i - p_j| \geq r$</td>
<td>最小间距保证</td>
</tr>
<tr>
<td>ε-采样条件</td>
<td>$|x - p| \leq \epsilon \cdot \text{lfs}(x)$</td>
<td>拓扑保证条件</td>
</tr>
<tr>
<td>Tikhonov正则化</td>
<td>$\min |P-S|^2 + \lambda R(S)$</td>
<td>病态问题求解</td>
</tr>
<tr>
<td>条件数</td>
<td>$\kappa = \sigma_{\max}/\sigma_{\min}$</td>
<td>稳定性度量</td>
</tr>
</tbody>
</table>
<h2 id="_6">练习题</h2>
<h3 id="1-4">基础题（1-4）</h3>
<p><strong>习题 3.1</strong> 证明在二维平面上，六边形网格是最优的均匀采样模式（覆盖效率最高）。</p>
<details>
<summary>提示（Hint）</summary>
<p>考虑单位圆的覆盖问题，比较正方形、三角形和六边形网格的覆盖密度。</p>
</details>
<details>
<summary>参考答案</summary>
<p>对于半径为$r$的圆形覆盖：</p>
<ul>
<li>正方形网格：每个圆覆盖面积$4r^2$，覆盖率$\pi/4 \approx 78.5\%$</li>
<li>六边形网格：每个圆覆盖面积$2\sqrt{3}r^2$，覆盖率$\pi/(2\sqrt{3}) \approx 90.7\%$</li>
</ul>
<p>六边形排列达到平面最密堆积，因此是最优的均匀采样模式。</p>
</details>
<p><strong>习题 3.2</strong> 给定一个带宽为$W$的2D信号，如果使用极坐标采样（径向$N_r$个采样，角向$N_\theta$个采样），推导避免混叠的采样条件。</p>
<details>
<summary>提示（Hint）</summary>
<p>考虑极坐标下的Jacobian变换，注意外圈的弧长采样密度。</p>
</details>
<details>
<summary>参考答案</summary>
<p>极坐标采样在半径$r$处的弧长间隔为$\Delta s = r \cdot \Delta\theta = r \cdot 2\pi/N_\theta$。
为避免混叠：$\Delta s \leq \pi/W$
因此：$N_\theta \geq 2rW$</p>
<p>对于最大半径$R$：$N_\theta \geq 2RW$
径向：$N_r \geq RW/\pi$</p>
</details>
<p><strong>习题 3.3</strong> 实现Bridson算法时，为什么背景网格的单元大小选择为$r/\sqrt{d}$（$d$是维度）？</p>
<details>
<summary>提示（Hint）</summary>
<p>考虑$d$维超立方体的对角线长度。</p>
</details>
<details>
<summary>参考答案</summary>
<p>选择$r/\sqrt{d}$保证每个网格单元的对角线长度恰好为$r$：
$$\text{对角线} = \sqrt{d \cdot (r/\sqrt{d})^2} = r$$
这确保了：</p>
<ol>
<li>每个单元最多包含一个采样点</li>
<li>只需检查相邻的$3^d - 1$个单元即可验证距离约束</li>
<li>查询复杂度为$O(1)$</li>
</ol>
</details>
<p><strong>习题 3.4</strong> 证明Delaunay三角化最大化最小角的性质（在所有可能的三角化中）。</p>
<details>
<summary>提示（Hint）</summary>
<p>使用局部边翻转（edge flip）操作和角度单调性证明。</p>
</details>
<details>
<summary>参考答案</summary>
<p>考虑四点凸包的两种三角化：</p>
<ul>
<li>对角线AC：角度集合$\{\alpha_1, \alpha_2, \beta_1, \beta_2\}$</li>
<li>对角线BD：角度集合$\{\gamma_1, \gamma_2, \delta_1, \delta_2\}$</li>
</ul>
<p>Delaunay条件（空圆性）等价于：$\alpha_1 + \alpha_2 \leq \pi$</p>
<p>可以证明：若违反Delaunay条件，则翻转边后最小角增大。
通过归纳法，任何三角化都可通过一系列边翻转达到Delaunay三角化，且每次翻转都不减小最小角。</p>
</details>
<h3 id="5-8">挑战题（5-8）</h3>
<p><strong>习题 3.5</strong> 设计一个算法，在给定曲面的ε-采样基础上，自动确定需要额外采样的区域以保证重建质量。考虑如何定量评估当前采样的充分性。</p>
<details>
<summary>提示（Hint）</summary>
<p>利用Voronoi顶点到采样点的距离估计局部特征尺寸，结合极点理论。</p>
</details>
<details>
<summary>参考答案</summary>
<p>算法框架：</p>
<ol>
<li>计算Voronoi图，识别极点（Voronoi顶点距离最远的两个）</li>
<li>估计局部特征尺寸：$\widehat{\text{lfs}}(p) = |p - v_{\text{pole}}|$</li>
<li>计算采样质量因子：$q(p) = \max_{x \in V(p)} |x - p|/\widehat{\text{lfs}}(p)$</li>
<li>若$q(p) &gt; \epsilon_{\text{target}}$，在Voronoi区域最远点添加新采样</li>
<li>迭代直到所有$q(p) \leq \epsilon_{\text{target}}$</li>
</ol>
<p>该方法保证渐进收敛到目标ε-采样密度。</p>
</details>
<p><strong>习题 3.6</strong> 分析并比较不同采样模式（均匀、随机、泊松盘、蓝噪声）的功率谱特性。如何根据重建算法的频率响应选择最优采样策略？</p>
<details>
<summary>提示（Hint）</summary>
<p>考虑采样模式的径向功率谱与重建核的频率响应的卷积关系。</p>
</details>
<details>
<summary>参考答案</summary>
<p>功率谱分析：</p>
<ul>
<li>均匀采样：$P(f) = \sum_k \delta(f - kf_s)$，离散尖峰</li>
<li>随机采样：$P(f) = \text{const}$，白噪声</li>
<li>泊松盘：$P(f) \propto f^{0.5}$（2D），缺失低频</li>
<li>蓝噪声：$P(f) \propto f$，线性增长</li>
</ul>
<p>选择策略：</p>
<ol>
<li>若重建核是理想低通：选择蓝噪声（高频噪声被滤除）</li>
<li>若重建包含非线性处理：选择泊松盘（避免聚集）</li>
<li>若需要频谱分析：选择均匀采样（频谱可预测）</li>
<li>若计算资源受限：选择随机采样（实现简单）</li>
</ol>
<p>最优配对通过最小化重建误差的期望值确定：
$$E[\epsilon^2] = \int P_{\text{sample}}(f) \cdot |1 - H_{\text{recon}}(f)|^2 df$$</p>
</details>
<p><strong>习题 3.7</strong> 推导在存在各向异性噪声$\mathcal{N}(0, \Sigma)$（$\Sigma$非对角）情况下的最优MLS投影参数。如何自适应调整局部坐标系？</p>
<details>
<summary>提示（Hint）</summary>
<p>使用主成分分析（PCA）估计噪声协方差，在变换空间中求解。</p>
</details>
<details>
<summary>参考答案</summary>
<p>各向异性MLS优化：</p>
<ol>
<li>
<p>估计局部噪声协方差：
$$\hat{\Sigma} = \frac{1}{|N(x)|} \sum_{p_i \in N(x)} (p_i - \bar{p})(p_i - \bar{p})^T$$</p>
</li>
<li>
<p>特征分解：$\hat{\Sigma} = Q\Lambda Q^T$</p>
</li>
<li>
<p>变换到主轴坐标：$\tilde{p}_i = Q^T(p_i - x)$</p>
</li>
<li>
<p>各向异性权重：
$$w(x, p_i) = \exp\left(-\sum_{j=1}^3 \frac{\tilde{p}_{ij}^2}{2h_j^2}\right)$$
其中$h_j = \alpha\sqrt{\lambda_j}$，$\alpha$是全局平滑参数。</p>
</li>
<li>
<p>在变换空间求解，再变换回原空间</p>
</li>
</ol>
<p>这种方法自动适应局部噪声结构，在噪声主方向上使用更大的平滑核。</p>
</details>
<p><strong>习题 3.8</strong> 设计一个理论框架，统一描述从不同数据源（点云、体素、图像）到网格的重建问题。定义通用的适定性条件和最优性准则。</p>
<details>
<summary>提示（Hint）</summary>
<p>考虑将所有输入表示为测度空间上的分布，定义统一的逼近理论。</p>
</details>
<details>
<summary>参考答案</summary>
<p>统一框架：</p>
<p><strong>输入空间</strong>：测度$\mu$在$\mathbb{R}^3$上</p>
<ul>
<li>点云：$\mu = \sum_i \delta_{p_i}$</li>
<li>体素：$\mu = \sum_{ijk} v_{ijk} \cdot \mathbf{1}_{V_{ijk}}$</li>
<li>图像：$\mu$由多视图反投影确定</li>
</ul>
<p><strong>输出空间</strong>：2-流形$\mathcal{M} \subset \mathbb{R}^3$</p>
<p><strong>重建泛函</strong>：
$$\mathcal{R}[\mu] = \arg\min_{\mathcal{M}} D(\mu, \mu_{\mathcal{M}}) + \lambda \cdot R(\mathcal{M})$$
其中：</p>
<ul>
<li>$D$是分布距离（如Wasserstein距离）</li>
<li>$\mu_{\mathcal{M}}$是曲面$\mathcal{M}$诱导的测度</li>
<li>$R$是几何正则化项</li>
</ul>
<p><strong>适定性条件</strong>：</p>
<ol>
<li>测度集中性：$\text{supp}(\mu)$是$\epsilon$-Hausdorff逼近</li>
<li>正则性：$R(\mathcal{M}^*) &lt; \infty$</li>
<li>唯一性：$D$在$\mathcal{M}^*$邻域严格凸</li>
</ol>
<p><strong>最优性</strong>：
$$\mathcal{M}^* = \arg\min_{\mathcal{M}} \mathbb{E}_{\mu}[\text{dist}(X, \mathcal{M})^2] + \lambda \int_{\mathcal{M}} H^2 dS$$</p>
<p>该框架统一了各种重建方法，提供了理论分析的通用工具。</p>
</details>
<h2 id="gotchas">常见陷阱与错误 (Gotchas)</h2>
<h3 id="1">1. 采样密度不足导致的拓扑错误</h3>
<p><strong>问题</strong>：采样稀疏区域可能产生错误的连接或孔洞。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>薄结构断裂</li>
<li>小特征消失</li>
<li>错误的亏格（孔数）</li>
</ul>
<p><strong>解决方法</strong>：</p>
<ul>
<li>使用ε-采样理论估算所需密度</li>
<li>在高曲率区域增加采样</li>
<li>后处理检查拓扑一致性</li>
</ul>
<h3 id="2-delaunay">2. Delaunay三角化的退化情况</h3>
<p><strong>问题</strong>：共球点导致Delaunay不唯一。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>数值不稳定</li>
<li>细条三角形（sliver）</li>
<li>算法崩溃</li>
</ul>
<p><strong>解决方法</strong>：</p>
<ul>
<li>使用符号扰动（SoS，Simulation of Simplicity）</li>
<li>添加微小随机扰动</li>
<li>使用鲁棒的几何谓词库</li>
</ul>
<h3 id="3_1">3. 噪声放大问题</h3>
<p><strong>问题</strong>：重建算法可能放大输入噪声。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>表面粗糙</li>
<li>虚假振荡</li>
<li>法向不连续</li>
</ul>
<p><strong>调试技巧</strong>：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">计算重建算子的条件数</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">分析频率响应</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">逐步增加正则化参数</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">使用交叉验证选择参数</span>
</code></pre></div>

<h3 id="4">4. 边界处理不当</h3>
<p><strong>问题</strong>：开放曲面的边界重建困难。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>边界收缩</li>
<li>错误填充孔洞</li>
<li>边界锯齿</li>
</ul>
<p><strong>最佳实践</strong>：</p>
<ul>
<li>显式标记边界点</li>
<li>使用受限Delaunay</li>
<li>边界专用采样策略</li>
</ul>
<h3 id="5">5. 尺度不一致</h3>
<p><strong>问题</strong>：不同尺度特征需要不同采样密度。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>大特征过采样</li>
<li>小特征欠采样</li>
<li>计算资源浪费</li>
</ul>
<p><strong>多尺度策略</strong>：</p>
<ul>
<li>分层采样（octree）</li>
<li>局部特征尺寸估计</li>
<li>自适应细化</li>
</ul>
<h3 id="6">6. 数值精度问题</h3>
<p><strong>问题</strong>：浮点运算导致的几何谓词错误。</p>
<p><strong>症状</strong>：</p>
<ul>
<li>拓扑不一致</li>
<li>自交</li>
<li>算法死循环</li>
</ul>
<p><strong>解决方案</strong>：</p>
<ul>
<li>使用精确几何计算库（CGAL、Predicates）</li>
<li>实现鲁棒的方向测试</li>
<li>避免接近退化的配置</li>
</ul>
<h3 id="_7">调试建议清单</h3>
<ul>
<li>[ ] 可视化采样分布（检查聚集/空隙）</li>
<li>[ ] 计算并显示局部采样密度热图</li>
<li>[ ] 验证Delaunay三角化的空球性质</li>
<li>[ ] 检查重建曲面的法向一致性</li>
<li>[ ] 测量Hausdorff距离评估重建质量</li>
<li>[ ] 分析功率谱验证采样质量</li>
<li>[ ] 使用已知解的合成数据测试</li>
<li>[ ] 逐步增加问题复杂度调试</li>
</ul>
<hr />
<p><a href="chapter2.html">← 第2章：几何处理基础</a> | <a href="index.html">目录</a> | <a href="chapter4.html">第4章：Marching Cubes与体素方法 →</a></p>
            </article>
            
            <nav class="page-nav"><a href="chapter2.html" class="nav-link prev">← 第2章：几何处理基础</a><a href="chapter4.html" class="nav-link next">第4章：Marching Cubes与体素方法 →</a></nav>
        </main>
    </div>
</body>
</html>